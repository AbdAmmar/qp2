

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>becke_numerical_grid &mdash; Quantum Package 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="bitmask module" href="bitmask.html" />
    <link rel="prev" title="aux_quantities" href="aux_quantities.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Quantum Package
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/selected_ci.html">Selected Configuration Interaction</a></li>
</ul>
<p class="caption"><span class="caption-text">User's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/quickstart.html">Quick-start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/interfaces.html">Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/excited_states.html">Excited states</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/natural_orbitals.html">Natural orbitals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/printing.html">Printing the near-<abbr title="Full Configuration Interaction">FCI</abbr> wave function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/plugins.html">Working with external plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/qp_plugins.html">qp_plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/index.html">Index of commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide/index.html#index-of-programs">Index of programs</a></li>
</ul>
<p class="caption"><span class="caption-text">Programmer's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../programmers_guide/programming.html">Programming in the <em>Quantum Package</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../programmers_guide/ezfio.html">EZFIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programmers_guide/plugins.html">Developing plugins</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../programmers_guide/index.html">Index for programmers</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../programmers_guide/index.html#index-of-modules">Index of Modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ao_basis.html">ao_basis</a></li>
<li class="toctree-l3"><a class="reference internal" href="ao_one_e_ints.html">ao_one_e_integrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="ao_two_e_erf_ints.html">ao_two_e_erf_ints</a></li>
<li class="toctree-l3"><a class="reference internal" href="ao_two_e_ints.html">ao_two_e_ints</a></li>
<li class="toctree-l3"><a class="reference internal" href="aux_quantities.html">aux_quantities</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">becke_numerical_grid</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ezfio-parameters">EZFIO parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#providers">Providers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#subroutines-functions">Subroutines / functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bitmask.html">bitmask module</a></li>
<li class="toctree-l3"><a class="reference internal" href="cipsi.html">cipsi</a></li>
<li class="toctree-l3"><a class="reference internal" href="cis.html">cis</a></li>
<li class="toctree-l3"><a class="reference internal" href="cisd.html">cisd</a></li>
<li class="toctree-l3"><a class="reference internal" href="davidson.html">davidson</a></li>
<li class="toctree-l3"><a class="reference internal" href="davidson_dressed.html">davidson_dressed</a></li>
<li class="toctree-l3"><a class="reference internal" href="davidson_undressed.html">davidson_undressed</a></li>
<li class="toctree-l3"><a class="reference internal" href="density_for_dft.html">density_for_dft</a></li>
<li class="toctree-l3"><a class="reference internal" href="determinants.html">determinants</a></li>
<li class="toctree-l3"><a class="reference internal" href="dft_keywords.html">dft_keywords</a></li>
<li class="toctree-l3"><a class="reference internal" href="dft_utils_in_r.html">dft_utils_in_r</a></li>
<li class="toctree-l3"><a class="reference internal" href="dft_utils_one_e.html">dft_utils_one_e</a></li>
<li class="toctree-l3"><a class="reference internal" href="dressing.html">dress_zmq</a></li>
<li class="toctree-l3"><a class="reference internal" href="electrons.html">electrons</a></li>
<li class="toctree-l3"><a class="reference internal" href="ezfio_files.html">ezfio_files</a></li>
<li class="toctree-l3"><a class="reference internal" href="fci.html">fci</a></li>
<li class="toctree-l3"><a class="reference internal" href="generators_cas.html">generators_cas</a></li>
<li class="toctree-l3"><a class="reference internal" href="generators_full.html">generators_full</a></li>
<li class="toctree-l3"><a class="reference internal" href="hartree_fock.html">hartree_fock</a></li>
<li class="toctree-l3"><a class="reference internal" href="iterations.html">iterations</a></li>
<li class="toctree-l3"><a class="reference internal" href="kohn_sham.html">kohn_sham</a></li>
<li class="toctree-l3"><a class="reference internal" href="kohn_sham_rs.html">kohn_sham_rs</a></li>
<li class="toctree-l3"><a class="reference internal" href="mo_basis.html">mo_basis</a></li>
<li class="toctree-l3"><a class="reference internal" href="mo_guess.html">mo_guess</a></li>
<li class="toctree-l3"><a class="reference internal" href="mo_one_e_ints.html">mo_one_e_integrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="mo_two_e_erf_ints.html">mo_two_e_erf_ints</a></li>
<li class="toctree-l3"><a class="reference internal" href="mo_two_e_ints.html">mo_two_e_ints</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpi.html">mpi</a></li>
<li class="toctree-l3"><a class="reference internal" href="nuclei.html">nuclei</a></li>
<li class="toctree-l3"><a class="reference internal" href="perturbation.html">perturbation</a></li>
<li class="toctree-l3"><a class="reference internal" href="pseudo.html">pseudo</a></li>
<li class="toctree-l3"><a class="reference internal" href="psiref_cas.html">psiref_cas</a></li>
<li class="toctree-l3"><a class="reference internal" href="psiref_utils.html">psiref_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="scf_utils.html">scf_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="selectors_cassd.html">selectors_cassd</a></li>
<li class="toctree-l3"><a class="reference internal" href="selectors_full.html">selectors_full</a></li>
<li class="toctree-l3"><a class="reference internal" href="selectors_utils.html">selectors_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="single_ref_method.html">single_ref_method</a></li>
<li class="toctree-l3"><a class="reference internal" href="tools.html">tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="zmq.html">zmq</a></li>
<li class="toctree-l3"><a class="reference internal" href="../programmers_guide/qp_name.html">qp_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../programmers_guide/qp_test.html">qp_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../programmers_guide/conventions.html">Coding conventions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../programmers_guide/index.html#index-of-providers">Index of Providers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programmers_guide/index.html#index-of-subroutines-functions">Index of Subroutines/Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../programmers_guide/plugins.html">Developing plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/research.html">Some research made with the <em>Quantum Package</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/contributors.html">Contributors</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Quantum Package</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../programmers_guide/index.html">Index for programmers</a> &raquo;</li>
        
      <li>becke_numerical_grid</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/modules/becke_numerical_grid.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="becke-numerical-grid">
<span id="module-becke-numerical-grid"></span><h1>becke_numerical_grid<a class="headerlink" href="#becke-numerical-grid" title="Permalink to this headline">¶</a></h1>
<p>This module contains all quantities needed to build Becke’s grid used in general for DFT integration. Note that it can be used for whatever integration in R^3 as long as the functions to be integrated are mostly concentrated near the atomic regions.</p>
<p>This grid is built as the reunion of a spherical grid around each atom. Each spherical grid contains
a certain number of radial and angular points. No pruning is done on the angular part of the grid.</p>
<p>The main keyword for that module is:</p>
<ul class="simple">
<li><a class="reference internal" href="#cmdoption-becke-numerical-grid-arg-grid-type-sgn"><code class="xref std std-option docutils literal notranslate"><span class="pre">becke_numerical_grid</span> <span class="pre">grid_type_sgn</span></code></a> which controls the precision of the grid according the standard <strong>SG-n</strong> grids. This keyword controls the two providers <code class="xref std std-option docutils literal notranslate"><span class="pre">n_points_integration_angular</span></code> <code class="xref std std-option docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code>.</li>
</ul>
<p>The main providers of that module are:</p>
<ul class="simple">
<li><code class="xref std std-option docutils literal notranslate"><span class="pre">n_points_integration_angular</span></code> which is the number of angular integration points. WARNING: it obeys to specific rules so it cannot be any integer number. Some of the possible values are [ 50 | 74 | 170 | 194 | 266 | 302 | 590 | 1202 | 2030 | 5810 ] for instance. See <code class="file docutils literal notranslate"><span class="pre">angular.f</span></code> for more details.</li>
<li><code class="xref std std-option docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code> which is the number of radial angular points. This can be any strictly positive integer. Nevertheless, a minimum of 50 is in general necessary.</li>
<li><code class="xref std std-option docutils literal notranslate"><span class="pre">final_grid_points</span></code> which are the (x,y,z) coordinates of the grid points.</li>
<li><code class="xref std std-option docutils literal notranslate"><span class="pre">final_weight_at_r_vector</span></code> which are the weights at each grid point</li>
</ul>
<p>For a simple example of how to use the grid, see <code class="file docutils literal notranslate"><span class="pre">example.irp.f</span></code>.</p>
<p>The spherical integration uses Lebedev-Laikov grids, which was used from the code distributed through CCL (<a class="reference external" href="http://www.ccl.net/">http://www.ccl.net/</a>).
See next section for explanations and citation policies.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>This subroutine is part of a set of subroutines that generate
Lebedev grids [1-6] for integration on a sphere. The original
C-code [1] was kindly provided by Dr. Dmitri N. Laikov and
translated into fortran by Dr. Christoph van Wuellen.
This subroutine was translated using a C to fortran77 conversion
tool written by Dr. Christoph van Wuellen.

Users of this code are asked to include reference [1] in their
publications, and in the user- and programmers-manuals
describing their codes.

This code was distributed through CCL (http://www.ccl.net/).

[1] V.I. Lebedev, and D.N. Laikov
    &quot;A quadrature formula for the sphere of the 131st
     algebraic order of accuracy&quot;
    Doklady Mathematics, Vol. 59, No. 3, 1999, pp. 477-481.

[2] V.I. Lebedev
    &quot;A quadrature formula for the sphere of 59th algebraic
     order of accuracy&quot;
    Russian Acad. Sci. Dokl. Math., Vol. 50, 1995, pp. 283-286.

[3] V.I. Lebedev, and A.L. Skorokhodov
    &quot;Quadrature formulas of orders 41, 47, and 53 for the sphere&quot;
    Russian Acad. Sci. Dokl. Math., Vol. 45, 1992, pp. 587-592.

[4] V.I. Lebedev
    &quot;Spherical quadrature formulas exact to orders 25-29&quot;
    Siberian Mathematical Journal, Vol. 18, 1977, pp. 99-107.

[5] V.I. Lebedev
    &quot;Quadratures on a sphere&quot;
    Computational Mathematics and Mathematical Physics, Vol. 16,
    1976, pp. 10-24.

[6] V.I. Lebedev
    &quot;Values of the nodes and weights of ninth to seventeenth
     order Gauss-Markov quadrature formulae invariant under the
     octahedron group with inversion&quot;
    Computational Mathematics and Mathematical Physics, Vol. 15,
    1975, pp. 44-51.
</pre></div>
</div>
<div class="section" id="ezfio-parameters">
<h2>EZFIO parameters<a class="headerlink" href="#ezfio-parameters" title="Permalink to this headline">¶</a></h2>
<dl class="option">
<dt id="cmdoption-becke-numerical-grid-arg-grid-type-sgn">
<code class="descname">grid_type_sgn</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-becke-numerical-grid-arg-grid-type-sgn" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of grid used for the Becke’s numerical grid. Can be, by increasing accuracy: [ 0 | 1 | 2 | 3 ]</p>
<p>Default: 2</p>
</dd></dl>

</div>
<div class="section" id="providers">
<h2>Providers<a class="headerlink" href="#providers" title="Permalink to this headline">¶</a></h2>
<dl class="var">
<dt id="c.alpha_knowles">
<code class="descname">alpha_knowles</code><a class="headerlink" href="#c.alpha_knowles" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/integration_radial.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">alpha_knowles</span>        <span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>Recommended values for the alpha parameters according to the paper of Knowles (JCP, 104, 1996)
as a function of the nuclear charge</p>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.angular_quadrature_points">
<code class="descname">angular_quadrature_points</code><a class="headerlink" href="#c.angular_quadrature_points" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">angular_quadrature_points</span>    <span class="p">(</span><span class="n">n_points_integration_angular</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">weights_angular_points</span>       <span class="p">(</span><span class="n">n_points_integration_angular</span><span class="p">)</span>
</pre></div>
</div>
<p>weights and grid points for the integration on the angular variables on
the unit sphere centered on (0,0,0)
According to the LEBEDEV scheme</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.dr_radial_integral">
<code class="descname">dr_radial_integral</code><a class="headerlink" href="#c.dr_radial_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">grid_points_radial</span>   <span class="p">(</span><span class="n">n_points_radial_grid</span><span class="p">)</span>
<span class="n">double</span> <span class="n">precision</span>        <span class="p">::</span> <span class="n">dr_radial_integral</span>
</pre></div>
</div>
<p>points in [0,1] to map the radial integral [0,infty]</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.final_grid_points">
<code class="descname">final_grid_points</code><a class="headerlink" href="#c.final_grid_points" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke_vector.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">final_grid_points</span>    <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">final_weight_at_r_vector</span>     <span class="p">(</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">integer</span><span class="p">,</span> <span class="n">allocatable</span>    <span class="p">::</span> <span class="n">index_final_points</span>   <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">integer</span><span class="p">,</span> <span class="n">allocatable</span>    <span class="p">::</span> <span class="n">index_final_points_reverse</span>   <span class="p">(</span><span class="n">n_points_integration_angular</span><span class="p">,</span><span class="n">n_points_radial_grid</span><span class="p">,</span><span class="n">nucl_num</span><span class="p">)</span>


<span class="n">final_grid_points</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">/</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">jth</span> <span class="n">grid</span> <span class="n">point</span>
</pre></div>
</div>
<p>final_weight_at_r_vector(i) = Total weight function of the ith grid point which contains the Lebedev, Voronoi and radial weights contributions</p>
<p>index_final_points(1:3,i) = gives the angular, radial and atomic indices associated to the ith grid point</p>
<p>index_final_points_reverse(i,j,k) = index of the grid point having i as angular, j as radial and l as atomic indices</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_final_grid" title="n_points_final_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_final_grid</span></code></a></li>
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_num</span></code></li>
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_grad_in_r_array" title="aos_grad_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_grad_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_in_r_array" title="aos_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_lapl_in_r_array" title="aos_lapl_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_lapl_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_sr_vc_alpha_lda_w" title="aos_sr_vc_alpha_lda_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_sr_vc_alpha_lda_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_sr_vc_alpha_pbe_w" title="aos_sr_vc_alpha_pbe_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_sr_vc_alpha_pbe_w</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_vc_alpha_lda_w" title="aos_vc_alpha_lda_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_vc_alpha_lda_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_vc_alpha_pbe_w" title="aos_vc_alpha_pbe_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_vc_alpha_pbe_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_sr_x_lda" title="energy_sr_x_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_sr_x_lda</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_sr_x_pbe" title="energy_sr_x_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_sr_x_pbe</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_x_lda" title="energy_x_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_x_lda</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_x_pbe" title="energy_x_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_x_pbe</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.mos_in_r_array" title="mos_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">mos_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_alpha_at_r" title="one_e_dm_alpha_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_alpha_at_r</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_and_grad_alpha_in_r" title="one_e_dm_and_grad_alpha_in_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_and_grad_alpha_in_r</span></code></a></li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.final_weight_at_r">
<code class="descname">final_weight_at_r</code><a class="headerlink" href="#c.final_weight_at_r" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">final_weight_at_r</span>    <span class="p">(</span><span class="n">n_points_integration_angular</span><span class="p">,</span><span class="n">n_points_radial_grid</span><span class="p">,</span><span class="n">nucl_num</span><span class="p">)</span>
</pre></div>
</div>
<p>Total weight on each grid point which takes into account all Lebedev, Voronoi and radial weights.</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.alpha_knowles" title="alpha_knowles"><code class="xref c c-data docutils literal notranslate"><span class="pre">alpha_knowles</span></code></a></li>
<li><a class="reference internal" href="#c.angular_quadrature_points" title="angular_quadrature_points"><code class="xref c c-data docutils literal notranslate"><span class="pre">angular_quadrature_points</span></code></a></li>
<li><a class="reference internal" href="#c.grid_points_radial" title="grid_points_radial"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_radial</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.m_knowles" title="m_knowles"><code class="xref c c-data docutils literal notranslate"><span class="pre">m_knowles</span></code></a></li>
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_charge</span></code></li>
</ul>
</td><td><ul class="simple">
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_num</span></code></li>
<li><a class="reference internal" href="#c.weight_at_r" title="weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">weight_at_r</span></code></a></li>
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_grid_points" title="final_grid_points"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_grid_points</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_final_grid" title="n_points_final_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_final_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.final_weight_at_r_vector">
<code class="descname">final_weight_at_r_vector</code><a class="headerlink" href="#c.final_weight_at_r_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke_vector.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">final_grid_points</span>    <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">final_weight_at_r_vector</span>     <span class="p">(</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">integer</span><span class="p">,</span> <span class="n">allocatable</span>    <span class="p">::</span> <span class="n">index_final_points</span>   <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">integer</span><span class="p">,</span> <span class="n">allocatable</span>    <span class="p">::</span> <span class="n">index_final_points_reverse</span>   <span class="p">(</span><span class="n">n_points_integration_angular</span><span class="p">,</span><span class="n">n_points_radial_grid</span><span class="p">,</span><span class="n">nucl_num</span><span class="p">)</span>


<span class="n">final_grid_points</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">/</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">jth</span> <span class="n">grid</span> <span class="n">point</span>
</pre></div>
</div>
<p>final_weight_at_r_vector(i) = Total weight function of the ith grid point which contains the Lebedev, Voronoi and radial weights contributions</p>
<p>index_final_points(1:3,i) = gives the angular, radial and atomic indices associated to the ith grid point</p>
<p>index_final_points_reverse(i,j,k) = index of the grid point having i as angular, j as radial and l as atomic indices</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_final_grid" title="n_points_final_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_final_grid</span></code></a></li>
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_num</span></code></li>
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_grad_in_r_array" title="aos_grad_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_grad_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_in_r_array" title="aos_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_lapl_in_r_array" title="aos_lapl_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_lapl_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_sr_vc_alpha_lda_w" title="aos_sr_vc_alpha_lda_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_sr_vc_alpha_lda_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_sr_vc_alpha_pbe_w" title="aos_sr_vc_alpha_pbe_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_sr_vc_alpha_pbe_w</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_vc_alpha_lda_w" title="aos_vc_alpha_lda_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_vc_alpha_lda_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_vc_alpha_pbe_w" title="aos_vc_alpha_pbe_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_vc_alpha_pbe_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_sr_x_lda" title="energy_sr_x_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_sr_x_lda</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_sr_x_pbe" title="energy_sr_x_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_sr_x_pbe</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_x_lda" title="energy_x_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_x_lda</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_x_pbe" title="energy_x_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_x_pbe</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.mos_in_r_array" title="mos_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">mos_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_alpha_at_r" title="one_e_dm_alpha_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_alpha_at_r</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_and_grad_alpha_in_r" title="one_e_dm_and_grad_alpha_in_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_and_grad_alpha_in_r</span></code></a></li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.grid_points_per_atom">
<code class="descname">grid_points_per_atom</code><a class="headerlink" href="#c.grid_points_per_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">grid_points_per_atom</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n_points_integration_angular</span><span class="p">,</span><span class="n">n_points_radial_grid</span><span class="p">,</span><span class="n">nucl_num</span><span class="p">)</span>
</pre></div>
</div>
<p>x,y,z coordinates of grid points used for integration in 3d space</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.alpha_knowles" title="alpha_knowles"><code class="xref c c-data docutils literal notranslate"><span class="pre">alpha_knowles</span></code></a></li>
<li><a class="reference internal" href="#c.angular_quadrature_points" title="angular_quadrature_points"><code class="xref c c-data docutils literal notranslate"><span class="pre">angular_quadrature_points</span></code></a></li>
<li><a class="reference internal" href="#c.grid_points_radial" title="grid_points_radial"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_radial</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.m_knowles" title="m_knowles"><code class="xref c c-data docutils literal notranslate"><span class="pre">m_knowles</span></code></a></li>
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_charge</span></code></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="nuclei.html#c.nucl_coord" title="nucl_coord"><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_coord</span></code></a></li>
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_num</span></code></li>
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_grid_points" title="final_grid_points"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_grid_points</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_alpha_in_r" title="one_e_dm_alpha_in_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_alpha_in_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.weight_at_r" title="weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">weight_at_r</span></code></a></li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.grid_points_radial">
<code class="descname">grid_points_radial</code><a class="headerlink" href="#c.grid_points_radial" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">grid_points_radial</span>   <span class="p">(</span><span class="n">n_points_radial_grid</span><span class="p">)</span>
<span class="n">double</span> <span class="n">precision</span>        <span class="p">::</span> <span class="n">dr_radial_integral</span>
</pre></div>
</div>
<p>points in [0,1] to map the radial integral [0,infty]</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.index_final_points">
<code class="descname">index_final_points</code><a class="headerlink" href="#c.index_final_points" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke_vector.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">final_grid_points</span>    <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">final_weight_at_r_vector</span>     <span class="p">(</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">integer</span><span class="p">,</span> <span class="n">allocatable</span>    <span class="p">::</span> <span class="n">index_final_points</span>   <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">integer</span><span class="p">,</span> <span class="n">allocatable</span>    <span class="p">::</span> <span class="n">index_final_points_reverse</span>   <span class="p">(</span><span class="n">n_points_integration_angular</span><span class="p">,</span><span class="n">n_points_radial_grid</span><span class="p">,</span><span class="n">nucl_num</span><span class="p">)</span>


<span class="n">final_grid_points</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">/</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">jth</span> <span class="n">grid</span> <span class="n">point</span>
</pre></div>
</div>
<p>final_weight_at_r_vector(i) = Total weight function of the ith grid point which contains the Lebedev, Voronoi and radial weights contributions</p>
<p>index_final_points(1:3,i) = gives the angular, radial and atomic indices associated to the ith grid point</p>
<p>index_final_points_reverse(i,j,k) = index of the grid point having i as angular, j as radial and l as atomic indices</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_final_grid" title="n_points_final_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_final_grid</span></code></a></li>
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_num</span></code></li>
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_grad_in_r_array" title="aos_grad_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_grad_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_in_r_array" title="aos_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_lapl_in_r_array" title="aos_lapl_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_lapl_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_sr_vc_alpha_lda_w" title="aos_sr_vc_alpha_lda_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_sr_vc_alpha_lda_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_sr_vc_alpha_pbe_w" title="aos_sr_vc_alpha_pbe_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_sr_vc_alpha_pbe_w</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_vc_alpha_lda_w" title="aos_vc_alpha_lda_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_vc_alpha_lda_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_vc_alpha_pbe_w" title="aos_vc_alpha_pbe_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_vc_alpha_pbe_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_sr_x_lda" title="energy_sr_x_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_sr_x_lda</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_sr_x_pbe" title="energy_sr_x_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_sr_x_pbe</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_x_lda" title="energy_x_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_x_lda</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_x_pbe" title="energy_x_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_x_pbe</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.mos_in_r_array" title="mos_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">mos_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_alpha_at_r" title="one_e_dm_alpha_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_alpha_at_r</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_and_grad_alpha_in_r" title="one_e_dm_and_grad_alpha_in_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_and_grad_alpha_in_r</span></code></a></li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.index_final_points_reverse">
<code class="descname">index_final_points_reverse</code><a class="headerlink" href="#c.index_final_points_reverse" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke_vector.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">final_grid_points</span>    <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">final_weight_at_r_vector</span>     <span class="p">(</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">integer</span><span class="p">,</span> <span class="n">allocatable</span>    <span class="p">::</span> <span class="n">index_final_points</span>   <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">n_points_final_grid</span><span class="p">)</span>
   <span class="n">integer</span><span class="p">,</span> <span class="n">allocatable</span>    <span class="p">::</span> <span class="n">index_final_points_reverse</span>   <span class="p">(</span><span class="n">n_points_integration_angular</span><span class="p">,</span><span class="n">n_points_radial_grid</span><span class="p">,</span><span class="n">nucl_num</span><span class="p">)</span>


<span class="n">final_grid_points</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">/</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">jth</span> <span class="n">grid</span> <span class="n">point</span>
</pre></div>
</div>
<p>final_weight_at_r_vector(i) = Total weight function of the ith grid point which contains the Lebedev, Voronoi and radial weights contributions</p>
<p>index_final_points(1:3,i) = gives the angular, radial and atomic indices associated to the ith grid point</p>
<p>index_final_points_reverse(i,j,k) = index of the grid point having i as angular, j as radial and l as atomic indices</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_final_grid" title="n_points_final_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_final_grid</span></code></a></li>
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_num</span></code></li>
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_grad_in_r_array" title="aos_grad_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_grad_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_in_r_array" title="aos_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_lapl_in_r_array" title="aos_lapl_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_lapl_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_sr_vc_alpha_lda_w" title="aos_sr_vc_alpha_lda_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_sr_vc_alpha_lda_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_sr_vc_alpha_pbe_w" title="aos_sr_vc_alpha_pbe_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_sr_vc_alpha_pbe_w</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_vc_alpha_lda_w" title="aos_vc_alpha_lda_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_vc_alpha_lda_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_vc_alpha_pbe_w" title="aos_vc_alpha_pbe_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_vc_alpha_pbe_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_sr_x_lda" title="energy_sr_x_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_sr_x_lda</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_sr_x_pbe" title="energy_sr_x_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_sr_x_pbe</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_x_lda" title="energy_x_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_x_lda</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_x_pbe" title="energy_x_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_x_pbe</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.mos_in_r_array" title="mos_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">mos_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_alpha_at_r" title="one_e_dm_alpha_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_alpha_at_r</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_and_grad_alpha_in_r" title="one_e_dm_and_grad_alpha_in_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_and_grad_alpha_in_r</span></code></a></li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.m_knowles">
<code class="descname">m_knowles</code><a class="headerlink" href="#c.m_knowles" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">integer</span> <span class="p">::</span> <span class="n">m_knowles</span>
</pre></div>
</div>
<p>value of the “m” parameter in the equation (7) of the paper of Knowles (JCP, 104, 1996)</p>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.n_points_final_grid">
<code class="descname">n_points_final_grid</code><a class="headerlink" href="#c.n_points_final_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke_vector.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">integer</span> <span class="p">::</span> <span class="n">n_points_final_grid</span>
</pre></div>
</div>
<p>Number of points which are non zero</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_num</span></code></li>
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_grad_in_r_array" title="aos_grad_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_grad_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_in_r_array" title="aos_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.aos_lapl_in_r_array" title="aos_lapl_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_lapl_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_sr_vc_alpha_lda_w" title="aos_sr_vc_alpha_lda_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_sr_vc_alpha_lda_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_sr_vc_alpha_pbe_w" title="aos_sr_vc_alpha_pbe_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_sr_vc_alpha_pbe_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_vc_alpha_lda_w" title="aos_vc_alpha_lda_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_vc_alpha_lda_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.aos_vc_alpha_pbe_w" title="aos_vc_alpha_pbe_w"><code class="xref c c-data docutils literal notranslate"><span class="pre">aos_vc_alpha_pbe_w</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_sr_x_lda" title="energy_sr_x_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_sr_x_lda</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_sr_x_pbe" title="energy_sr_x_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_sr_x_pbe</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_x_lda" title="energy_x_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_x_lda</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.energy_x_pbe" title="energy_x_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">energy_x_pbe</span></code></a></li>
<li><a class="reference internal" href="#c.final_grid_points" title="final_grid_points"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_grid_points</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.mos_grad_in_r_array" title="mos_grad_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">mos_grad_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.mos_in_r_array" title="mos_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">mos_in_r_array</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.mos_lapl_in_r_array" title="mos_lapl_in_r_array"><code class="xref c c-data docutils literal notranslate"><span class="pre">mos_lapl_in_r_array</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_alpha_at_r" title="one_e_dm_alpha_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_alpha_at_r</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_and_grad_alpha_in_r" title="one_e_dm_and_grad_alpha_in_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_and_grad_alpha_in_r</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.potential_sr_c_alpha_ao_lda" title="potential_sr_c_alpha_ao_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">potential_sr_c_alpha_ao_lda</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.potential_sr_x_alpha_ao_lda" title="potential_sr_x_alpha_ao_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">potential_sr_x_alpha_ao_lda</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.potential_sr_x_alpha_ao_pbe" title="potential_sr_x_alpha_ao_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">potential_sr_x_alpha_ao_pbe</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.potential_x_alpha_ao_lda" title="potential_x_alpha_ao_lda"><code class="xref c c-data docutils literal notranslate"><span class="pre">potential_x_alpha_ao_lda</span></code></a></li>
<li><a class="reference internal" href="dft_utils_one_e.html#c.potential_x_alpha_ao_pbe" title="potential_x_alpha_ao_pbe"><code class="xref c c-data docutils literal notranslate"><span class="pre">potential_x_alpha_ao_pbe</span></code></a></li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.n_points_grid_per_atom">
<code class="descname">n_points_grid_per_atom</code><a class="headerlink" href="#c.n_points_grid_per_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">integer</span> <span class="p">::</span> <span class="n">n_points_grid_per_atom</span>
</pre></div>
</div>
<p>Number of grid points per atom</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.n_points_integration_angular">
<code class="descname">n_points_integration_angular</code><a class="headerlink" href="#c.n_points_integration_angular" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">integer</span> <span class="p">::</span> <span class="n">n_points_radial_grid</span>
<span class="n">integer</span> <span class="p">::</span> <span class="n">n_points_integration_angular</span>
</pre></div>
</div>
<p>n_points_radial_grid = number of radial grid points per atom</p>
<p>n_points_integration_angular = number of angular grid points per atom</p>
<p>These numbers are automatically set by setting the grid_type_sgn parameter</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_type_sgn</span></code></li>
</ul>
</td><td><ul class="simple">
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.angular_quadrature_points" title="angular_quadrature_points"><code class="xref c c-data docutils literal notranslate"><span class="pre">angular_quadrature_points</span></code></a></li>
<li><a class="reference internal" href="#c.final_grid_points" title="final_grid_points"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_grid_points</span></code></a></li>
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
<li><a class="reference internal" href="#c.grid_points_radial" title="grid_points_radial"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_radial</span></code></a></li>
<li><a class="reference internal" href="#c.n_points_final_grid" title="n_points_final_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_final_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_grid_per_atom" title="n_points_grid_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_grid_per_atom</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_alpha_in_r" title="one_e_dm_alpha_in_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_alpha_in_r</span></code></a></li>
<li><a class="reference internal" href="#c.weight_at_r" title="weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">weight_at_r</span></code></a></li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.n_points_radial_grid">
<code class="descname">n_points_radial_grid</code><a class="headerlink" href="#c.n_points_radial_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">integer</span> <span class="p">::</span> <span class="n">n_points_radial_grid</span>
<span class="n">integer</span> <span class="p">::</span> <span class="n">n_points_integration_angular</span>
</pre></div>
</div>
<p>n_points_radial_grid = number of radial grid points per atom</p>
<p>n_points_integration_angular = number of angular grid points per atom</p>
<p>These numbers are automatically set by setting the grid_type_sgn parameter</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_type_sgn</span></code></li>
</ul>
</td><td><ul class="simple">
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.angular_quadrature_points" title="angular_quadrature_points"><code class="xref c c-data docutils literal notranslate"><span class="pre">angular_quadrature_points</span></code></a></li>
<li><a class="reference internal" href="#c.final_grid_points" title="final_grid_points"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_grid_points</span></code></a></li>
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
<li><a class="reference internal" href="#c.grid_points_radial" title="grid_points_radial"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_radial</span></code></a></li>
<li><a class="reference internal" href="#c.n_points_final_grid" title="n_points_final_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_final_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_grid_per_atom" title="n_points_grid_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_grid_per_atom</span></code></a></li>
<li><a class="reference internal" href="dft_utils_in_r.html#c.one_e_dm_alpha_in_r" title="one_e_dm_alpha_in_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">one_e_dm_alpha_in_r</span></code></a></li>
<li><a class="reference internal" href="#c.weight_at_r" title="weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">weight_at_r</span></code></a></li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.weight_at_r">
<code class="descname">weight_at_r</code><a class="headerlink" href="#c.weight_at_r" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">weight_at_r</span>  <span class="p">(</span><span class="n">n_points_integration_angular</span><span class="p">,</span><span class="n">n_points_radial_grid</span><span class="p">,</span><span class="n">nucl_num</span><span class="p">)</span>
</pre></div>
</div>
<p>Weight function at grid points : w_n(r) according to the equation (22)
of Becke original paper (JCP, 88, 1988)</p>
<p>The “n” discrete variable represents the nucleis which in this array is
represented by the last dimension and the points are labelled by the
other dimensions.</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="nuclei.html#c.nucl_coord_transp" title="nucl_coord_transp"><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_coord_transp</span></code></a></li>
<li><a class="reference internal" href="nuclei.html#c.nucl_dist_inv" title="nucl_dist_inv"><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_dist_inv</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_num</span></code></li>
<li><a class="reference internal" href="nuclei.html#c.slater_bragg_type_inter_distance_ua" title="slater_bragg_type_inter_distance_ua"><code class="xref c c-data docutils literal notranslate"><span class="pre">slater_bragg_type_inter_distance_ua</span></code></a></li>
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
</dd></dl>

<dl class="var">
<dt id="c.weights_angular_points">
<code class="descname">weights_angular_points</code><a class="headerlink" href="#c.weights_angular_points" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/grid_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">angular_quadrature_points</span>    <span class="p">(</span><span class="n">n_points_integration_angular</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">double</span> <span class="n">precision</span><span class="p">,</span> <span class="n">allocatable</span>   <span class="p">::</span> <span class="n">weights_angular_points</span>       <span class="p">(</span><span class="n">n_points_integration_angular</span><span class="p">)</span>
</pre></div>
</div>
<p>weights and grid points for the integration on the angular variables on
the unit sphere centered on (0,0,0)
According to the LEBEDEV scheme</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
<p>Needed by:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
</ul>
</td><td><ul class="simple">
</ul>
</td></tr></table>
</dd></dl>

</div>
<div class="section" id="subroutines-functions">
<h2>Subroutines / functions<a class="headerlink" href="#subroutines-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="c.cell_function_becke:">
<code class="descname">cell_function_becke:</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.cell_function_becke:" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/step_function_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span> <span class="n">function</span> <span class="n">cell_function_becke</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">atom_number</span><span class="p">)</span>
</pre></div>
</div>
<p>atom_number :: atom on which the cell function of Becke (1988, JCP,88(4))
r(1:3)                       :: x,y,z coordinantes of the current point</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="nuclei.html#c.nucl_dist_inv" title="nucl_dist_inv"><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_dist_inv</span></code></a></li>
<li><a class="reference internal" href="nuclei.html#c.slater_bragg_type_inter_distance_ua" title="slater_bragg_type_inter_distance_ua"><code class="xref c c-data docutils literal notranslate"><span class="pre">slater_bragg_type_inter_distance_ua</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="nuclei.html#c.nucl_coord_transp" title="nucl_coord_transp"><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_coord_transp</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_num</span></code></li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="function">
<dt id="c.derivative_knowles_function:">
<code class="descname">derivative_knowles_function:</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.derivative_knowles_function:" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/integration_radial.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span> <span class="n">function</span> <span class="n">derivative_knowles_function</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Derivative of the function proposed by Knowles (JCP, 104, 1996) for distributing the radial points</p>
</dd></dl>

<dl class="function">
<dt id="c.example_becke_numerical_grid:">
<code class="descname">example_becke_numerical_grid:</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.example_becke_numerical_grid:" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/example.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subroutine</span> <span class="n">example_becke_numerical_grid</span>
</pre></div>
</div>
<p>subroutine that illustrates the main features available in becke_numerical_grid</p>
<p>Needs:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><a class="reference internal" href="#c.n_points_final_grid" title="n_points_final_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_final_grid</span></code></a></li>
<li><a class="reference internal" href="#c.final_weight_at_r" title="final_weight_at_r"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_weight_at_r</span></code></a></li>
<li><a class="reference internal" href="#c.n_points_radial_grid" title="n_points_radial_grid"><code class="xref c c-data docutils literal notranslate"><span class="pre">n_points_radial_grid</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="#c.grid_points_per_atom" title="grid_points_per_atom"><code class="xref c c-data docutils literal notranslate"><span class="pre">grid_points_per_atom</span></code></a></li>
<li><a class="reference internal" href="#c.final_grid_points" title="final_grid_points"><code class="xref c c-data docutils literal notranslate"><span class="pre">final_grid_points</span></code></a></li>
</ul>
</td><td><ul class="simple">
<li><a class="reference internal" href="nuclei.html#c.nucl_coord" title="nucl_coord"><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_coord</span></code></a></li>
<li><code class="xref c c-data docutils literal notranslate"><span class="pre">nucl_num</span></code></li>
</ul>
</td></tr></table>
</dd></dl>

<dl class="function">
<dt id="c.f_function_becke:">
<code class="descname">f_function_becke:</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.f_function_becke:" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/step_function_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span> <span class="n">function</span> <span class="n">f_function_becke</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.knowles_function:">
<code class="descname">knowles_function:</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.knowles_function:" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/integration_radial.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span> <span class="n">function</span> <span class="n">knowles_function</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Function proposed by Knowles (JCP, 104, 1996) for distributing the radial points :
the Log “m” function ( equation (7) in the paper )</p>
</dd></dl>

<dl class="function">
<dt id="c.step_function_becke:">
<code class="descname">step_function_becke:</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.step_function_becke:" title="Permalink to this definition">¶</a></dt>
<dd><p>File : <code class="file docutils literal notranslate"><span class="pre">becke_numerical_grid/step_function_becke.irp.f</span></code></p>
<div class="code fortran highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="n">precision</span> <span class="n">function</span> <span class="n">step_function_becke</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Step function of the Becke paper (1988, JCP,88(4))</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bitmask.html" class="btn btn-neutral float-right" title="bitmask module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="aux_quantities.html" class="btn btn-neutral" title="aux_quantities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, A. Scemama, E. Giner

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>